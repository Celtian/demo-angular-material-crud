import{a as Pt,b as Tt}from"./chunk-YWPOIHRK.js";import{a as ut,b as ft,e as ht,g as _t,h as y,j as xt,k as Ct,o as St,p as vt,q as bt,r as gt,t as yt,u as Et,v as It}from"./chunk-TZBM6JE2.js";import{a as D}from"./chunk-IJB5AQ53.js";import{a as wt}from"./chunk-LXJG3WNU.js";import{a as Dt,b as F,c as kt}from"./chunk-QOHJDPT6.js";import{G as Mt,c as w,e as J,f as K,g as X,h as Y,i as Z,j as mt}from"./chunk-XCWFWD7F.js";import{a as Nt,b as Ot,c as Rt,d as Vt,e as Ft,f as jt}from"./chunk-EFDGKIWB.js";import{a as Bt}from"./chunk-CFO6YHFP.js";import{$c as E,A as P,Aa as o,Ba as r,Ca as x,Cb as V,D as B,Ga as b,Hc as tt,Ic as et,Jc as it,K as A,Ka as g,L as z,Ma as f,Mc as at,Nc as nt,P as C,Q as S,Qa as d,Qc as ot,Ra as h,Rc as rt,Sa as T,Sc as st,Va as $,Vc as lt,Wc as ct,Xa as R,Xc as dt,Ya as G,Za as s,_a as l,_c as pt,cb as Q,db as q,ea as a,fa as p,fb as H,ia as U,m as j,oa as N,pa as u,r as M,ra as O,v as L,va as v,vb as W,wa as _,x as k}from"./chunk-AUZXOHMO.js";function Ht(e,c){if(e&1){let i=b();o(0,"div",11)(1,"button",12),g("click",function(){C(i);let t=f(2);return S(t.onDelete())}),d(2),s(3,"translate"),r()()}e&2&&(a(2),h(l(3,1,"uni.delete")))}function Wt(e,c){if(e&1){let i=b();o(0,"button",13),g("click",function(){C(i);let t=f(2);return t.form.controls.title.setValue(""),S(t.form.controls.body.markAsDirty())}),s(1,"translate"),s(2,"translate"),o(3,"mat-icon"),d(4,"close"),r()()}e&2&&(u("matTooltip",l(2,4,"uni.clear")),N("aria-label",l(1,2,"uni.clear")))}function Jt(e,c){if(e&1){let i=b();o(0,"button",13),g("click",function(){C(i);let t=f(2);return t.form.controls.body.setValue(""),S(t.form.controls.body.markAsDirty())}),s(1,"translate"),s(2,"translate"),o(3,"mat-icon"),d(4,"close"),r()()}e&2&&(u("matTooltip",l(2,4,"uni.clear")),N("aria-label",l(1,2,"uni.clear")))}function Kt(e,c){if(e&1){let i=b();v(0,Ht,4,3,"div",1),o(1,"mat-card")(2,"mat-card-header")(3,"mat-card-subtitle"),d(4),r(),o(5,"mat-card-title"),d(6),r()(),o(7,"mat-card-content",2)(8,"form",3),g("ngSubmit",function(){C(i);let t=f();return S(t.onSubmit())})("reset",function(t){C(i);let m=f();return S(m.onReset(t))}),o(9,"mat-form-field",4)(10,"mat-label"),d(11),s(12,"translate"),r(),x(13,"input",5),v(14,Wt,5,6,"button",6),r(),o(15,"mat-form-field",4)(16,"mat-label"),d(17),s(18,"translate"),r(),x(19,"textarea",7),s(20,"translate"),v(21,Jt,5,6,"button",6),r(),o(22,"div",8)(23,"button",9),d(24),s(25,"translate"),r(),o(26,"button",10),d(27),s(28,"translate"),r()()()()()}if(e&2){let i=f();_(0,i.dataSource.state()==="data"?0:-1),a(3),O("blur-sm",i.dataSource.state()!=="data"),a(1),h("#"+i.dataSource.data().id),a(1),O("blur-sm",i.dataSource.state()!=="data"),a(1),h(i.dataSource.data().title),a(2),u("formGroup",i.form),a(3),h(l(12,17,"form.post.title.label")),a(3),_(14,i.form.controls.title.value?14:-1),a(3),h(l(18,19,"form.post.body.label")),a(2),u("placeholder",l(20,21,"form.post.body.placeholder")),a(2),_(21,i.form.controls.body.value?21:-1),a(2),u("disabled",i.form.pristine),a(1),T(" ",l(25,23,"uni.reset")," "),a(2),u("disabled",i.form.pristine||i.form.invalid),a(1),T(" ",l(28,25,"uni.submit")," ")}}function Xt(e,c){if(e&1&&(o(0,"mat-card")(1,"mat-card-content",14),x(2,"mat-icon",15),o(3,"div"),d(4),r()()()),e&2){let i=f();a(4),h(i.dataSource.error())}}function Yt(e,c){e&1&&(o(0,"mat-card")(1,"mat-card-content",14),x(2,"mat-icon",16),o(3,"div"),d(4),s(5,"translate"),r()()()),e&2&&(a(4),h(l(5,1,"error.post-was-not-found")))}var Zt=(e,c)=>[e,c],Lt=e=>[e];function te(e,c){if(e&1&&(x(0,"mat-icon",19),o(1,"a",18),s(2,"localize"),d(3),r(),x(4,"mat-icon",19),o(5,"a",18),s(6,"localize"),d(7),s(8,"translate"),r()),e&2){let i=f(2);a(1),u("routerLink",G(10,Zt,l(2,4,"/"),i.dataSource.data().id)),a(2),h(i.dataSource.data().id),a(2),u("routerLink",R(13,Lt,l(6,6,"/"+i.dataSource.data().id+"/"+i.ROUTE_DEFINITION.POSTS.EDIT))),a(2),T(" ",l(8,8,"breadcrumbs.posts.edit"),"")}}function ee(e,c){if(e&1&&(o(0,"div",17)(1,"a",18),s(2,"localize"),d(3),s(4,"translate"),r(),v(5,te,9,15),r()),e&2){let i=f();a(1),u("routerLink",R(7,Lt,l(2,3,"/"))),a(2),h(l(4,5,"breadcrumbs.app.posts")),a(2),_(5,i.dataSource.state()==="data"?5:-1)}}var $e=(()=>{let c=class c{constructor(n,t,m,I,At,zt,Ut,$t,Gt,Qt,qt){this.apiService=n,this.route=t,this.translate=m,this.breadcrumbsPortalService=I,this.fb=At,this.snackBar=zt,this.language=Ut,this.seoService=$t,this.lr=Gt,this.confirm=Qt,this.router=qt,this.destroyRef=A(U),this.dataSource=new wt(D),this.ROUTE_DEFINITION=E,this.form=this.fb.nonNullable.group({title:["",[y.required,y.min(3)]],body:["",[y.required,y.min(3)]]})}canDeactivate(){return this.form.pristine||this.confirm.openCustomConfirmDialog(F.UnsavedWork)}ngOnInit(){this.breadcrumbsPortalService.setPortal(this.portalContent);let n=this.route.paramMap.pipe(j(t=>t.get("id")));n.pipe(M(t=>!Number.isNaN(Number(t))),P(t=>this.language.language$.pipe(B({next:()=>{let m=this.lr.translateRoute(`/${t}/${E.POSTS.EDIT}`);this.seoService.setSeo({title:this.translate.instant(`SEO.${E.POSTS.EDIT}.title`),description:this.translate.instant(`SEO.${E.POSTS.EDIT}.description`)},m)}}))),V(this.destroyRef)).subscribe(),n.pipe(L(500),B(t=>{Number.isNaN(Number(t))&&this.dataSource.setData(D)}),M(t=>!Number.isNaN(Number(t))),P(t=>this.apiService.detail(Number(t))),V(this.destroyRef)).subscribe({next:t=>{this.dataSource.setData(t),this.form.patchValue(t)},error:t=>{if(t instanceof W&&t.status>=400&&t.status<500)this.dataSource.setData(D);else{let m=this.translate.instant("error.unexpected-exception");this.dataSource.setError(m)}}})}ngOnDestroy(){this.portalContent?.detach()}onSubmit(){this.apiService.patch(this.dataSource.data().id,this.form.value).pipe(k()).subscribe({next:n=>{this.dataSource.setData(n),this.form.reset(n),this.snackBar.open(this.translate.instant("response.update.success"),this.translate.instant("uni.close"))},error:()=>{this.snackBar.open(this.translate.instant("response.update.failed"),this.translate.instant("uni.close"))}})}onReset(n){n.preventDefault(),this.form.reset(this.dataSource.data())}onDelete(){this.confirm.openCustomConfirmDialog(F.Delete).pipe(k(),M(n=>!!n),P(()=>this.apiService.delete(this.dataSource.data().id))).subscribe({next:()=>{this.snackBar.open(this.translate.instant("response.delete.success"),this.translate.instant("uni.close"));let n=this.lr.translateRoute("/");this.router.navigate([n])},error:()=>{this.snackBar.open(this.translate.instant("response.delete.failed"),this.translate.instant("uni.close"))}})}};c.\u0275fac=function(t){return new(t||c)(p(Dt),p(it),p(ot),p(mt),p(gt),p(Mt),p(pt),p(Bt),p(lt),p(kt),p(at))},c.\u0275cmp=z({type:c,selectors:[["app-post-edit"]],viewQuery:function(t,m){if(t&1&&q(w,7),t&2){let I;Q(I=H())&&(m.portalContent=I.first)}},standalone:!0,features:[$],decls:4,vars:3,consts:[["class","container flex items-center gap-1 py-4",4,"cdkPortal"],["class","flex items-end justify-end gap-2"],[1,"flex","flex-col","gap-2","mt-2","text-center"],[3,"formGroup","ngSubmit","reset"],[1,"w-full"],["matInput","","type","text","formControlName","title"],["matSuffix","","mat-icon-button","",3,"matTooltip"],["matInput","","formControlName","body",3,"placeholder"],[1,"flex","justify-center","gap-2"],["mat-button","","color","primary","type","reset",3,"disabled"],["mat-flat-button","","color","primary","type","submit",3,"disabled"],[1,"flex","items-end","justify-end","gap-2"],["mat-button","","color","accent",3,"click"],["matSuffix","","mat-icon-button","",3,"matTooltip","click"],[1,"flex","flex-col","gap-2","text-center"],["aria-hidden","false","aria-label","Error icon","fontIcon","error"],["aria-hidden","false","aria-label","Warning icon","fontIcon","warning"],[1,"container","flex","items-center","gap-1","py-4"],["mat-button","","color","primary",3,"routerLink"],["aria-hidden","false","aria-label","Arrow icon","fontIcon","chevron_right"]],template:function(t,m){t&1&&v(0,Kt,29,27,"mat-card")(1,Xt,5,1,"mat-card")(2,Yt,6,3,"mat-card")(3,ee,6,9,"div",0),t&2&&(_(0,m.dataSource.state()==="loading"||m.dataSource.state()==="data"?0:-1),a(1),_(1,m.dataSource.state()==="error"?1:-1),a(1),_(2,m.dataSource.state()==="empty"?2:-1))},dependencies:[J,w,et,tt,Z,X,K,Y,jt,Nt,Rt,Ft,Vt,Ot,Tt,Pt,ht,ut,ft,It,Et,yt,St,_t,xt,Ct,vt,bt,st,rt,nt,dt,ct],styles:["[_nghost-%COMP%]{width:100%;margin-right:auto;margin-left:auto;padding-right:1rem;padding-left:1rem}@media (min-width: 640px){[_nghost-%COMP%]{max-width:640px}}@media (min-width: 768px){[_nghost-%COMP%]{max-width:768px}}@media (min-width: 1024px){[_nghost-%COMP%]{max-width:1024px}}@media (min-width: 1280px){[_nghost-%COMP%]{max-width:1280px}}@media (min-width: 1536px){[_nghost-%COMP%]{max-width:1536px}}[_nghost-%COMP%]{display:block}[_nghost-%COMP%] > [_ngcontent-%COMP%]:not([hidden]) ~ [_ngcontent-%COMP%]:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}[_nghost-%COMP%]{padding-top:1rem;padding-bottom:1rem}"],changeDetection:0});let e=c;return e})();export{$e as PostEditComponent};
